# One way ANOVA

## ANOVA Table

Let us consider an example where we have results from an experiment to compare yields (as measured by dried weight of plants) obtained under a control and two different treatment conditions. The dataset is named as `PlantGrowth` and it can be found in the library `car`.

```{r, message=FALSE}
# Loading the dataset
library(car)
library(DescTools)
data <- PlantGrowth
```

Let us print the anova table.

```{r}
anova(lm(weight ~ group, data = data))
```

The null hypothesis that all treatments are the same is rejected at a significance level of 5\%.

## Confidence interval

Let us print the Bonferroni's confidence intervals:

```{r}
aov_object <- aov(lm(weight ~ group, data = data))
PostHocTest(aov_object, method = "bonferroni")
```

Based on Bonferroni's method, we observe that treatment 1 and treatment 2 are significantly different, but there is no difference between other pairs.

Bonferroni's confidence intervals are overly conservative. Let us find the confidence intervals basead on Tukey's method:

```{r}
PostHocTest(aov_object, method = "hsd")
```

## Model assumptions check

The conclusions of the statistical tests and the confidence intervals are based on the assumption that random error is normally distributed with mean 0 and constant variance, i.e., $\epsilon_{ij} \sim N(0, \sigma^2)$. 

The diagnostic plots and statistical tests for checking model assumptions can be found [here](https://nustat.github.io/STAT350-class-notes/Diagnostics_Remedial_Measures.html#diagnostic-plots-statistical-tests).





