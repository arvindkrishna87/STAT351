{
  "hash": "131b5076a866c29ebeb52c41cb50edbe",
  "result": {
    "markdown": "# Hypothesis testing examples\n\n## t-test\n\n### Question\n\nCola manufacturers want to test how much the sweetness of a new cola drink is affected by storage. The sweetness loss due to storage was evaluated by 10 professional tasters (by comparing the sweetness before and after storage):\n\n```         \nTaster          Sweetness loss\n\n 1         2.0\n 2         0.4\n 3         0.7  \n 4         2.0  \n 5       −0.4   \n 6         2.2  \n 7       −1.3   \n 8         1.2  \n 9         1.1\n10         2.3\n```\n\nObviously, we want to test if storage results in a loss of sweetness\n\nLet $\\mu$ denote the sweetness loss, thus:\n\nNull hypothesis: $H_0: \\mu = 0$\n\nAlternate hypothesis: $H_a: \\mu > 0$\n\n### Solution\n\nSample mean ($\\bar{x}$):\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata <- c(2, 0.4, 0.7, 2, -0.4, 2.2, -1.3, 1.2, 1.1, 2.3)\n\nxbar <- mean(data)\nxbar\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 1.02\n```\n:::\n:::\n\n\nT-statistic:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nt = xbar/(sd(data)/sqrt(10))\nt\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 2.696689\n```\n:::\n:::\n\n\np-value:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n1-pt(t, df = 9)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.01226316\n```\n:::\n:::\n\n\nIf the probability of Type I error considered is 5%, then we reject the null hypothesis, and conclude that the sweetness loss is indeed greater than 0.\n\nIf the probability of Type I error considered is 1%, then we fail to reject the null hypothesis, and conclude that the sweetness loss is indeed 0.\n\n## Two-sample t-test\n\n### Question\n\nIn a study of lettuce growth, ten seedlings were randomly allocated to be grown in either a standard nutrient solution or in a solution containing extra nitrogen. After 22 days, the plants were harvested and weighed. The table below summarizes the results. Can we conclude that extra nitrogen enhances growth?\n\n| Nutrient solution | n   | mean |  SD  |\n|-------------------|:----|-----:|:----:|\n| Standard          | 5   | 3.62 | 0.54 |\n| Extra             | 5   | 4.17 | 0.67 |\n\n### Solution\n\nWe will first test the hypothesis if the variance of the responses corresponding to the two treatments are the same or not.\n\nWe will assume that the response follows the normal distribution.\n\nLet $\\sigma_{standard}^2$ denote the variance of the observations treated with standard solution, $\\sigma_{extra}^2$ denote the variance of the observations treated with extra nitrogen. Then,\n\nNull hypothesis: $\\sigma_{standard}^2 = \\sigma_{extra}^2$\n\nAlternate hypothesis: $\\sigma_{standard}^2 \\ne \\sigma_{extra}^2$\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# F-statistic:\nF = (0.54/0.67)^2\nF\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.6495879\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Critical values based on a significance level of 5%\nleft_tail_critical_value <- qf(0.025, 4, 4)\nleft_tail_critical_value\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.1041175\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nright_tail_critical_value <- qf(0.975, 4, 4)\nright_tail_critical_value\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 9.60453\n```\n:::\n:::\n\n\nAs the $F$-statistic is between the critical values, we do not reject the null hypothesis.\n\nThus, we will use the pooled-variance to conduct a 2-sample t-test for equality of means.\n\nLet $\\mu_{standard}$ denote the mean growth with the standard solution, $\\mu_{extra}$ denote the mean growth with extra nitrogen. Then,\n\nNull hypothesis: $\\mu_{standard} = \\mu_{extra}$\n\nAlternate hypothesis: $\\mu_{standard} \\ne \\mu_{extra}$\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Pooled variance\nsp2 = (0.54^2 + 0.67^2)/2\n\n# t-statistic\nt <- (3.62 - 4.17)/(sqrt(sp2*2/5))\n\n#p-value\n2*pt(t, 8)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.1908168\n```\n:::\n:::\n\n\nAs the $p$-value is high, we do not reject the null hypothesis that the extra nitrogen does not enhance growth.\n\nAlternatively, the Welch's test for unequal variances can be used without testing for equality of variances in the two samples.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nn = 5; s1 = 0.54; s2 = 0.67\nnu = (n-1)*(((s1^2 + s2^2)/n)^2)/(((s1^2)/n)^2+((s2^2)/n)^2)\nt0 <- (3.62 - 4.17)/(sqrt((s1^2+s2^2)/5))\n\n2*pt(t0, 7.654594)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.1924672\n```\n:::\n:::\n\n\nAs the power of Welch's t-test is similar to that of Student's t-test, even when the population variances are equal and sample sizes are balanced, Welch's test can always be used, irrespective of the variances being equal or not.\n\nHowever, if the variances are unequal, then Student's t-test must not be used. Type 1 error rate will be higher for a Student's t-test, particularly if one of the samples has a relatively higher variance, and a smaller sample size as compared to the other sample.\n\nThe functions `t.test()` and `power.t.test()` can be used to conveniently test the hypothesis, estimate confidence intervals, estimate power of the test, or the observations needed for a certain power of the test. Look at the documentation of these function, by executing the code `?t.test()` or `?power.t.test()` in the R console, to see the parameters you need to specify for using them.\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}