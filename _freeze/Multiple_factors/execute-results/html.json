{
  "hash": "58be4d733baa55498bd09b3817d04fdd",
  "result": {
    "markdown": "# Multiple factors\n\n## Randomized complete block design (RCBD)\n\nLet us consider an example, where the shear strength of steel plate girders needs to be modeled as a function of the four methods *(treatment)* and nine girders *(blocks)*.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ACSWR)\nlibrary(reshape2)\nlibrary(DescTools)\nlibrary(lmtest)\n\n# Visualizing treatment effects\ndata(\"girder\")\nboxplot(girder[,2:5])\n```\n\n::: {.cell-output-display}\n![](Multiple_factors_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Melting data to make it suitable to fit a linear regression model\n# using the 'lm' function\ndata_melt <- melt(girder, variable.name = \"treatment\", id = 'Girder')\nanova(lm(value~Girder+treatment, data = data_melt))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Variance Table\n\nResponse: value\n          Df  Sum Sq Mean Sq F value    Pr(>F)    \nGirder     8 0.08949 0.01119  1.6189    0.1717    \ntreatment  3 1.51381 0.50460 73.0267 3.296e-12 ***\nResiduals 24 0.16584 0.00691                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\nThe null hypothesis that there is no effect of the method on the sheer strength of the girder is rejected.\n\nLet us compare the methods pairwise.\n\n\n::: {.cell}\n\n```{.r .cell-code}\naov_object <- aov(value~Girder+treatment, data = data_melt)\n\n# Tukey's method\nPostHocTest(aov_object, method = \"hsd\")$treatment\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                        diff       lwr.ci      upr.ci         pval\nKarisruhe-Aarau    0.5452222  0.437124171  0.65332027 3.225975e-12\nLehigh-Aarau       0.2713333  0.163235283  0.37943138 2.106339e-06\nCardiff-Aarau      0.1106667  0.002568616  0.21876472 4.343575e-02\nLehigh-Karisruhe  -0.2738889 -0.381986940 -0.16579084 1.808447e-06\nCardiff-Karisruhe -0.4345556 -0.542653606 -0.32645750 3.675706e-10\nCardiff-Lehigh    -0.1606667 -0.268764717 -0.05256862 2.164599e-03\n```\n:::\n:::\n\n\nAll methods are different from each other according to Tukey's method *(at 5\\% significance level)*.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Bonferroni's method\nPostHocTest(aov_object, method = \"bonferroni\")$treatment\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                        diff       lwr.ci      upr.ci         pval\nKarisruhe-Aarau    0.5452222  0.432559601  0.65788484 3.308011e-12\nLehigh-Aarau       0.2713333  0.158670712  0.38399595 2.208198e-06\nCardiff-Aarau      0.1106667 -0.001995955  0.22332929 5.631958e-02\nLehigh-Karisruhe  -0.2738889 -0.386551510 -0.16122627 1.894578e-06\nCardiff-Karisruhe -0.4345556 -0.547218177 -0.32189293 3.770501e-10\nCardiff-Lehigh    -0.1606667 -0.273329288 -0.04800405 2.453939e-03\n```\n:::\n:::\n\n\nAll methods except Aarau and Cardiff are different from each other according to Bonferroni's method *(at 5\\% significance level)*. \n\nLet us verify if the model assumptions are satisfied.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow = c(2,2))\nmodel <- lm(value~Girder+treatment, data = data_melt)\nplot(model)\n```\n\n::: {.cell-output-display}\n![](Multiple_factors_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nshapiro.test(model$residuals)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tShapiro-Wilk normality test\n\ndata:  model$residuals\nW = 0.94966, p-value = 0.102\n```\n:::\n:::\n\n\nThe errors are normally distribued.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbptest(model)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tstudentized Breusch-Pagan test\n\ndata:  model\nBP = 22.205, df = 11, p-value = 0.02283\n```\n:::\n:::\n\n\nThe error variance assumption is also satisfied at a 1\\% significance level. There is no strong deviation from the assumption.\n\n\n## Two-way layout: Fixed effects\n\nA manufacturer was interested in finding differences in torque values of a lock-nut. The two factors effecting the torque are the type of plating, and whether the locknut is threaded into a bolt or a mandrel. We'll use two-way ANOVA to find if the two factors or their interaction effect the torque.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata <- read.table('bolt.dat.txt', header = TRUE)\ndata_melt <- melt(data, variable.name = 'plating', value.name = 'torque')\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nUsing M.B as id variables\n```\n:::\n\n```{.r .cell-code}\nhead(data_melt)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  M.B plating torque\n1   M     P.O     10\n2   M     P.O     13\n3   M     P.O     17\n4   M     P.O     16\n5   M     P.O     15\n6   M     P.O     14\n```\n:::\n\n```{.r .cell-code}\nanova(lm(torque ~ M.B*plating, data = data_melt))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Variance Table\n\nResponse: torque\n            Df Sum Sq Mean Sq F value    Pr(>F)    \nM.B          1  821.4  821.40 22.4563 1.604e-05 ***\nplating      2 2290.6 1145.32 31.3118 9.363e-10 ***\nM.B:plating  2  665.1  332.55  9.0916 0.0003952 ***\nResiduals   54 1975.2   36.58                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n```{.r .cell-code}\n#data['plating_bolt'] = apply(data_melt[,1:2], axis = 1, function(x) paste)\n```\n:::\n\n\nThe two factors and their interaction significantly effects the torque.\n\n## Two-way layout: Random effects\n\nTen food items are being tested by 5 judges *(operators)* for quality. Each judge inspects a food item 3 times, and gives a score. Answer the following questions with appropriate analysis:\n\n1. Is there a statistically significant variation in the scores given by judges for the same quality of food? If yes, quantify the variation.\n\n2. Is the variation in the scores given by judges for the same quality of food dependent on the food item?\n\n3. Is there a statistically significant variation in the quality of the food items after removing the variation in scores due to different judges? If yes, quantify the variation.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata <- read.csv('sensory_data.csv', header = TRUE)\nhead(data)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   Item Operator1 Operator2 Operator3 Operator4 Operator5\n1 Item1       4.3       4.9       3.3       5.3       4.4\n2 Item1       4.3       4.5       4.0       5.5       3.3\n3 Item1       4.1       5.3       3.4       5.7       4.7\n4 Item2       6.0       5.3       4.5       5.9       4.7\n5 Item2       4.9       6.3       4.2       5.5       4.9\n6 Item2       6.0       5.9       4.7       6.3       4.6\n```\n:::\n\n```{.r .cell-code}\ndata_melt <- melt(data, variable.name = \"Operator\", value.name = 'property')\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nUsing Item as id variables\n```\n:::\n\n```{.r .cell-code}\nhead(data_melt)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   Item  Operator property\n1 Item1 Operator1      4.3\n2 Item1 Operator1      4.3\n3 Item1 Operator1      4.1\n4 Item2 Operator1      6.0\n5 Item2 Operator1      4.9\n6 Item2 Operator1      6.0\n```\n:::\n\n```{.r .cell-code}\nanova(lm(property~Item*Operator, data = data_melt))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Variance Table\n\nResponse: property\n               Df Sum Sq Mean Sq  F value    Pr(>F)    \nItem            9 612.40  68.044 199.3084 < 2.2e-16 ***\nOperator        4  25.49   6.372  18.6643 1.739e-11 ***\nItem:Operator  36  12.97   0.360   1.0549     0.406    \nResiduals     100  34.14   0.341                       \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\nYes, there is a statistically significant variation in the scores given by judges for the same quality of food\n\nThe standard deviation in the scores given by judges for the same quality of food is:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsqrt((6.37 - 0.36)/30)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.4475861\n```\n:::\n:::\n\n\nThe variation in the scores given by judges for the same quality of food does not depend on the food item\n\nYes, there is a statistically significant variation in the quality of the food items after removing the variation in scores due to different judges.\n\nThe standard deviation in the scores given food items after removing the variation due to different judges is:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsqrt((68.04 - 0.36)/15)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 2.124147\n```\n:::\n:::\n",
    "supporting": [
      "Multiple_factors_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}