{
  "hash": "3817411fc7ac6e46aa964a4bfe4af281",
  "result": {
    "markdown": "# One way ANOVA\n\n## ANOVA Table\n\nLet us consider an example where we have results from an experiment to compare yields (as measured by dried weight of plants) obtained under a control and two different treatment conditions. The dataset is named as `PlantGrowth` and it can be found in the library `car`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Loading the dataset\nlibrary(car)\nlibrary(DescTools)\ndata <- PlantGrowth\n```\n:::\n\n\nLet us print the anova table.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nanova(lm(weight ~ group, data = data))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Variance Table\n\nResponse: weight\n          Df  Sum Sq Mean Sq F value  Pr(>F)  \ngroup      2  3.7663  1.8832  4.8461 0.01591 *\nResiduals 27 10.4921  0.3886                  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\nThe null hypothesis that all treatments are the same is rejected at a significance level of 5\\%.\n\n## Confidence interval\n\nLet us print the Bonferroni's confidence intervals:\n\n\n::: {.cell}\n\n```{.r .cell-code}\naov_object <- aov(lm(weight ~ group, data = data))\nPostHocTest(aov_object, method = \"bonferroni\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n  Posthoc multiple comparisons of means : Bonferroni \n    95% family-wise confidence level\n\n$group\n            diff     lwr.ci    upr.ci   pval    \ntrt1-ctrl -0.371 -1.0825786 0.3405786 0.5832    \ntrt2-ctrl  0.494 -0.2175786 1.2055786 0.2630    \ntrt2-trt1  0.865  0.1534214 1.5765786 0.0134 *  \n\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\nBased on Bonferroni's method, we observe that treatment 1 and treatment 2 are significantly different, but there is no difference between other pairs.\n\nBonferroni's confidence intervals are overly conservative. Let us find the confidence intervals basead on Tukey's method:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nPostHocTest(aov_object, method = \"hsd\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n  Posthoc multiple comparisons of means : Tukey HSD \n    95% family-wise confidence level\n\n$group\n            diff     lwr.ci    upr.ci   pval    \ntrt1-ctrl -0.371 -1.0622161 0.3202161 0.3909    \ntrt2-ctrl  0.494 -0.1972161 1.1852161 0.1980    \ntrt2-trt1  0.865  0.1737839 1.5562161 0.0120 *  \n\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\n## Model assumptions check\n\nThe conclusions of the statistical tests and the confidence intervals are based on the assumption that random error is normally distributed with mean 0 and constant variance, i.e., $\\epsilon_{ij} \\sim N(0, \\sigma^2)$. \n\nThe diagnostic plots and statistical tests for checking model assumptions can be found [here](https://nustat.github.io/STAT350-class-notes/Diagnostics_Remedial_Measures.html#diagnostic-plots-statistical-tests).\n\n## Contrasts\n\n### Class comparison\n\nThis is an example to use orthogonal contrasts to answer questions of interest. The data `rice_seed_data.csv` consists of the shoot dry weight (in mg) of an experiment to determine the effect of seed treatment by acids on the early growth of rice seeds.\n\nThe investigator had several specific questions in mind from the beginning: \n -Do acid treatments affect seedling growth?\n- Is the effect of organic acids different from that of inorganic acids?\n- Is there a difference in the effects of the two different organic acids?\n\nWe will create orthogonal contrasts, and perform an ANOVA analysis to answer these questions.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrice_data <- read.csv('rice_seed_data.csv')\nanova(lm(growth~treatment, data = rice_data))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Variance Table\n\nResponse: growth\n          Df  Sum Sq  Mean Sq F value    Pr(>F)    \ntreatment  3 0.87369 0.291232  33.874 3.669e-07 ***\nResiduals 16 0.13756 0.008597                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n```{.r .cell-code}\nc1 <- c(3, -1, -1, -1)\nc2 <- c(0, -2, 1, 1)\nc3 <- c(0, 0, 1, -1)\n\n# Contrast matrix\nmat.contrast <- cbind(c1, c2, c3)\ncolnames(mat.contrast) <- paste0(\"c\",1:3)\n\n# Converting treatment to a factor variable\nrice_data$treatment <- as.factor(rice_data$treatment)\ncontrasts(rice_data$treatment) <- mat.contrast\n\n# ANOVA table\nmodel <- aov(growth ~ treatment, data = rice_data,\n                   contrasts = list(treatment = mat.contrast))\n\n# Splitting the Treatment sum of squares into independent \n# orthogonal contrast components\nsummary.aov(model,split = list(treatment = list(\"Control vs acid\"=1,  \n                              \"Inorganic vs organic\" = 2, 'Between organic'=3)))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                                  Df Sum Sq Mean Sq F value   Pr(>F)    \ntreatment                          3 0.8737  0.2912  33.874 3.67e-07 ***\n  treatment: Control vs acid       1 0.7415  0.7415  86.244 7.61e-08 ***\n  treatment: Inorganic vs organic  1 0.1129  0.1129  13.126  0.00229 ** \n  treatment: Between organic       1 0.0194  0.0194   2.252  0.15293    \nResiduals                         16 0.1376  0.0086                     \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\nWe conclude that there is no statistically significant difference between the effect of organic acids. However, there is a statistically significant difference between the effect of inorganic and organic acids, and an even higher statistically significant difference between the weight of seeds in the control group and the weight seeds treated with acid.\n\n### Trend comparison\n\nThis is an example to identify if there is a linear, quadratic, or higher order relationship between a continuous treatment and the response.\n\nConsider the data `laser_power.csv`, which consists of laser power, and the corresponding strength of the material obtained using a machining process involving the laser. The question to be answered is if there is a linear or quadratic relationship between the laser power and strength of the material.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata <- read.csv('laser_power.csv')\ndata$power <- as.factor(data$power)\n\n# Linear contrast\nc1 <- c(-1, 0, 1)\n\n# Quadratic contrast\nc2 <- c(1, -2, 1)\n\nmat.contrast <- cbind(c1, c2)\nmodel <- aov(strength ~ power, data = data,\n             contrasts = list(power = mat.contrast))\nsummary.aov(model, split = list(power = list(\"linear\" = 1,\n                                                 \"quadratic\" = 2)))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                   Df Sum Sq Mean Sq F value  Pr(>F)   \npower               2 224.18  112.09  11.318 0.00920 **\n  power: linear     1 223.75  223.75  22.593 0.00315 **\n  power: quadratic  1   0.44    0.44   0.044 0.84083   \nResiduals           6  59.42    9.90                   \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\nWe conclude that there is a linear relationship between laser power and strength. This can be seen visually as well as below.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata$power <- as.integer(substr(data$power,5,8))\nplot(data$power, data$strength)\nabline(lm(strength~power, data = data))\n```\n\n::: {.cell-output-display}\n![](ANOVA_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "ANOVA_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}